@(eventOpt: Option[model.RichEvent.RichEvent], availableEvents: model.GroupedEvents)(implicit token: play.filters.csrf.CSRF.Token)

@import model.EventsByStatus
@import model.RichEvent._
@import views.support.Asset
@import views.html.helper.CSRF

@eventListItem(event: RichEvent) = {
    <li class="event-list__item js-searchable" data-search="@event.name.text">
        <a href="@routes.Staff.adminEdit(event.id)">@event.name.text</a>
    </li>
}

@listOfEvents(events: Seq[RichEvent], title: String) = {
    @if(events.length > 0) {
        <div class="tool-list__pane">
            <h2>@title events (@events.length items)</h2>
            <ul class="event-list event-list--scroll">
                @for(event <- events) {
                    @eventListItem(event)
                }
            </ul>
        </div>
    }
}

@tabPane(paneId: String, eventList: EventsByStatus, isActive: Boolean = false) = {
    <div class="tabs__content@if(isActive){ tabs__content--active}" id="@paneId">
        <div class="tool-list">
            @listOfEvents(eventList.live, "Live")
            @listOfEvents(eventList.draft, "Draft")
            @listOfEvents(eventList.past, "Past")
        </div>
    </div>
}

@staff.admin.template("EventHawk") {
    <div class="container">
        <div class="pane pane--nav">
            <img src="@Asset.at("images/admin/logo.png")" class="logo" />
            <ul class="nav">
                <li><a class="nav__item nav__item--selected" href="@routes.Staff.admin()">Event Admin Tool</a></li>
                <li><a class="nav__item" target="_blank" href="https://www.eventbrite.co.uk/">EventBrite</a></li>
                <li><a class="nav__item" target="_blank" href="http://soulmates-dashboard.event-analytics.guardianapis.com/membership">Dashboard</a></li>
                <li><a class="nav__item" target="_blank" href="https://media.gutools.co.uk/">The Grid</a></li>
            </ul>
            <aside class="padded">
                <h2>Quick links</h2>
                <ul class="option-list u-list-unstyled">
                    <li class="option-list__item"><a href="#" class="cta">Create a new event</a></li>
                    <li class="option-list__item"><a href="#" class="cta">Edit hero events</a></li>
                    <li class="option-list__item"><a href="#" class="cta">Bulk edit events</a></li>
                </ul>
            </aside>

            <p class="tagline">For a bird's eye view of events &bull; v0.1</p>
        </div>

        <div class="pane pane--tools">

            <h2>Event list</h2>
            <input type="text" class="search js-search" placeholder="Filter events by name..." />
            <ul class="tabs js-tabs" data-tab-pane="events-holder">
                <li><a href="#eventtab1" class="js-tabs__tab tabs__tab tabs__tab--active">Guardian Live</a></li>
                <li><a href="#eventtab2" class="js-tabs__tab tabs__tab">Local</a></li>
                <li><a href="#eventtab3" class="js-tabs__tab tabs__tab">Masterclasses</a></li>
            </ul>

            <div id="events-holder">
                @tabPane("eventtab1", availableEvents.guardianLive, true)
                @tabPane("eventtab2", availableEvents.guardianLocal)
                @tabPane("eventtab3", availableEvents.masterclasses)
            </div>

        </div>

         <div class="pane pane--main@if(!eventOpt) { pane--empty}">
            @for(event <- eventOpt) {
                <h3>@event.name.text</h3>
                <form action="@routes.Staff.adminUpdate(event.id)" method="POST" novalidate>
                    @CSRF.formField
                    <input type="hidden" name="ticketingProvider" id="ticketingProvider" value="eventbrite" />
                    <label for="gridUrl">Grid URL</label>
                    <input type="text" name="gridUrl" id="gridUrl" value="@event.eventMetadata.map(_.gridUrl).getOrElse("")"/>
                    <input type="submit" value="Save" class="cta" />
                </form>
            }
        </div>

    </div>
}
